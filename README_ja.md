 
Multi-Language Comment Script for CotEditor
================================================

CotEditor用のスクリプトです。

状況に合わせてインテリジェンスに振る舞いを判断し、選択範囲の コメントアウト(コメント化する) と コメント解除(コメント記号を取り除く) を行います。コーディング言語に依らない、共通したショートカットキーでのコメントアウト/解除が実現します。

特長
-------------
- そのときのシンタックス・カラーリング・モードによって自動的に挿入するコメント記号を判断します
- 複数行をラインコメント形式で一括コメントアウト/解除できます
- 選択範囲内のコメント行の割合に応じてコメントアウトとコメント解除を自動で切り替えます
- ブロックコメントとラインコメント、行頭コメントとカーソル位置での記号挿入を状況に応じて使い分けます
- 簡単にショートカットキーの変更や対応言語の追加などのカスタマイズができます
- 状況によらず常にコメントアウト・コメント解除をおこなうスクリプトも別途付属しています


対応している言語
-------------
CotEditor 1.3に同梱されているシンタックス（Perl, Ruby, PHPなど）
さらに、Apache, XML, HTML5, SVG, SQL,  Markdown, AppleScript, Go, Scheme, gnuplot, ImageJ, R および ReVIEW
（シンタックス名が一致する必要があります）

他、プリセットされていない言語も比較的簡単に付け足せます。


使い方
-------------
### インストール
CotEditorのScriptMenuフォルダに .scptファイル を入れて、スクリプトメニューからお使いください。

note: CotEditorのスクリプトメニューから「スクリプトフォルダを開く」を選択するとFinderで該当フォルダが開きます。

### アンインストール
ScriptMenuフォルダ内の .scptファイル を削除してください。


Comment, Comment Out, Uncomment スクリプトそれぞれの違い
-------------
メインスクリプトである Comment は自動でコメントアウトを行うか解除をを行うかを判断します。

一方 Comment Out, Uncomment スクリプトはそれぞれ、選択範囲内のコメント行の量に関わらず常にコメントアウト・コメント解除をします。それ以外の挙動はCommentスクリプトと同一です。

基本的には Comment でこと足りるとは思いますが、コメントアウト・解除にそれぞれ別のショートカットキーを割り振りたい方や、コメント行が多い箇所でさらに全体をコメントアウトしたいなどの場合を考慮して同梱しています。

それぞれのスクリプトは独立しているので必要なもののみを ScriptMenuフォルダ に入れて使えます。
  
  

解説
-------------
1つのスクリプト（ショートカット）で、状況に対応しつつ自在にコメントアウト・解除を行うことを目指しています。
具体的な振る舞いは実際に使用しながら体感して貰うのが一番だと思いますが、細かい挙動については以下のようになっています。

- 選択範囲をコメントアウトし、テキストが選択されていない場合はカーソル位置にコメント記号を挿入します。

- 既にコメントアウトされている行が範囲範囲内で一定の割合を超える場合は、逆に選択範囲の コメントの解除 を行います。
  このしきい値となる割合は変更可能でデフォルトでは1/2です。
  ただし、このコメント解除はラインコメントのみで有効で、またそのコメント記号が行頭にある必要があります。

- 行頭でのみコメントが許されている言語 (Apache と Shell Script) では常に、
  選択された行の行頭でコメントアウト・解除を行います。

- ラインコメントとブロックコメントの両方の方式を持つ言語では、
  選択された行が少ないときはラインコメント方式でコメントアウトします。
  このしきい値となる行数は変更可能でデフォルトでは10行です。
	
- 対応外のシンタックスのときは、実行しても特に何も起こりません。

### できないこと
以下のことは本スクリプトではできません。
- インデントされているコメントの解除
- ブロックコメントの解除


カスタマイズ
-------------
### ショートカットキー
CotEditorスクリプトのショートカットキーはファイル名を変更することで設定可能です。
デフォルトでは Comment にのみ Command + Shift + C がショートカットキーとして割り振られています。
詳しくはCotEditorのヘルプを参照してください。

### スクリプト内で設定できる値
Comment, Comment Out, Uncommentスクリプトは互いに独立しています。
従ってカスタマイズもそれぞれのスクリプトに対して行う必要があります。

- `spacer`
	コメント記号の後に入る空白を設定できます。
	
	デフォルト値：半角空白1つ

- `minBlockCommentLines`
	選択範囲がこの行数を超えたときにコメント方式をラインコメントからブロックコメントに切り替えます。
	
	デフォルト値：10行
	
- `commentLinesRate` [*Commentスクリプトのみ*]
	選択範囲に含まれるコメント行の割合がこの値を超えたときに、動作をコメントアウトからコメント解除に切り替えます。
	
	デフォルト値：1/2

- `looseSelect`
	ルーズセレクト モードを有効にします。
	このモードでは、複数行が選択されているとき選択開始/終了位置の如何にかかわらず選択された行の行頭から行末まで動作の対象にします。
	
	デフォルト値：false

### 言語の追加
対応言語を追加したい場合は、スクリプトを開いて前半のif文の辺りに見よう見まねで適当に足してください。


クレジット
-------------
- [CotEditor用スクリプト -Goodies -Works //ヴォルフロッシュ](http://wolfrosch.com/works/goodies/coteditor_scripts#comment)
- [repository on GitHub](https://github.com/1024jp/CommentScript-for-CotEditor)

### 作者
1024jp

- website: [ヴォルフロッシュ](http://wolfrosch.com/)
- twitter: @[1024jp](https://twitter.com/1024jp)
- github: [1024jp](https://github.com/1024jp)


ライセンス
-------------
本スクリプトは [クリエイティブ・コモンズ 表示 - 非営利 3.0 非移植 ライセンス](cc) の下に提供されています。
[cc]: http://creativecommons.org/licenses/by-nc/3.0/deed.ja

