 
Multi Comment Macro v1.1.4 for CotEditor
=======================================

CotEditor用のスクリプトです。

状況に合わせて振る舞いを判断し、選択範囲の コメントアウト(コメント化する) と コメント解除(コメント記号を取り除く) を行います。コーディング言語に依らない、共通したショートカットキーでのコメントアウト/解除が実現します。

### 特長
- そのときのシンタックス・カラーリング・モードによって自動的に挿入するコメント記号を判断します
- 複数行をラインコメント形式で一括コメントアウト/解除できます
- 選択範囲内のコメント行の割合に応じてコメントアウトとコメント解除を自動で切り替えます
- ブロックコメントとラインコメント、行頭コメントとカーソル位置での記号挿入を状況に応じて使い分けます
-  "ルーズセレクト モード" では雑に選択してもちゃんと行頭からコメントアウトを行います（デフォルトではoff）
- 簡単にショートカットキーの変更や対応言語の追加などのカスタマイズができます
- 状況によらず常にコメントアウト・コメント解除をおこなうスクリプトも別途付属しています


### 対応している言語
CotEditor 1.3に同梱されているシンタックス（Perl, Ruby, PHPなど）
さらに、Apache, XML, HTML5, SVG, SQL,  Markdown, AppleScript, CoffeeScript, YAML, INI, Go, Scheme, gnuplot, ImageJ, R および ReVIEW
（シンタックス名が一致する必要があります）

他、プリセットされていない言語も簡単に追加できます。


使い方
-------------
### インストール
CotEditorのScriptMenuフォルダに任意の .applescriptファイル を入れて、スクリプトメニューからお使いください。

note: CotEditorのスクリプトメニューから「スクリプトフォルダを開く」を選択するとFinderで該当フォルダが開きます。

### アンインストール
ScriptMenuフォルダ内の該当する .applescriptファイル を削除してください。


オプション・マクロ
-------------
Comment.applescript をもっと便利に使うためのオプション・スクリプトです。

それぞれのスクリプトは独立しているので必要なもののみを ScriptMenuフォルダ に入れて使えます。

### Select Lines
カーソルもしくは選択範囲を行頭から行末まで全て選択し直すスクリプトです。
ショートカットキーを用いてメインの Comment スクリプトと組み合わせることで
カーソルのある行全体を行頭からコメントアウトすることができます。

### Comment Out, Uncomment
メインスクリプトである Comment は自動でコメントアウトを行うか解除をを行うかを判断しますが、
一方 Comment Out, Uncomment スクリプトはそれぞれ、選択範囲内のコメント行の量に関わらず常にコメントアウト・コメント解除をします。
それ以外の挙動はCommentスクリプトと同一です (つまり、単にフラグで動作を固定しているだけです)。


解説
-------------
1つのスクリプト（ショートカット）で、状況に対応しつつ自在にコメントアウト・解除を行うことを目指しています。
具体的な振る舞いは実際に使用しながら体感して貰うのが一番だと思いますが、細かい挙動については以下のようになっています。

- 選択範囲をコメントアウトし、テキストが選択されていない場合はカーソル位置にコメント記号を挿入します。

- 既にコメントアウトされている行が範囲範囲内で一定の割合を超える場合は、逆に選択範囲の コメントの解除 を行います。
  このしきい値となる割合は変更可能でデフォルトでは2/3です。
  ただし、このコメント解除はラインコメントのみで有効で、またそのコメント記号が行頭にある必要があります。

- ブロックコメントを解除するためには、1つのブロックをスペースなくちょうど開始から終了まで選択する必要があります。

- 行頭でのみコメントが許されている言語 (Apache と Shell Script) では常に、
  選択された行の行頭でコメントアウト・解除を行います。

- ラインコメントとブロックコメントの両方の方式を持つ言語では、
  選択された行が少ないときはラインコメント方式でコメントアウトします。
  このしきい値となる行数は変更可能でデフォルトでは10行です。

- _ルーズセレクト モード_ では、選択開始/終了位置の如何にかかわらずコメントアウト/解除の対象が行単位になります。
  ただし、かわりに一部分だけをコメントアウトしたり、設定によっては空のコメント記号を挿入することも不可能になるので注意してください。
  *この機能はデフォルトではオフになっています*。
	
- 対応外のシンタックスのときは、実行しても特に何も起こりません。

### できないこと
以下のことは本スクリプトではできません。

- インデントされているコメントの解除（実装予定無し）
- 複数ブロックコメントの一括解除


カスタマイズ
-------------
### ショートカットキー
CotEditorスクリプトのショートカットキーはファイル名を変更することで設定可能です。
デフォルトでは Comment に Command + Shift + C が、
Select Lines に Command + Shift + A ショートカットキーとして割り振られています。
詳しくはCotEditorのヘルプを参照してください。

### スクリプト内で設定できる値
Comment, Comment Out, Uncommentスクリプトは互いに独立しています。
従ってカスタマイズもそれぞれのスクリプトに対して行う必要があります。

- `spacer`
	コメント記号の後に入る空白を設定できます
	
	デフォルト値：半角空白1つ

- `minBlockCommentLines`
	選択範囲がこの行数を超えたときにコメント方式をラインコメントからブロックコメントに切り替えます
	
	デフォルト値：10行

- `looseSelect`
	選択範囲がこの行数を超えたときに、ルーズセレクト モードに切り替わります。
	ただし、0を指定したときはこの機能が無効になります
	
	デフォルト値：0 (無効)
	
- `commentLinesRate` [Commentスクリプトのみ]
	選択範囲に含まれるコメント行の割合がこの値を超えたときに、動作をコメントアウトからコメント解除に切り替えます
	
	デフォルト値：2/3

### 言語の追加
対応言語を追加したい場合は、スクリプト中の `(insert additional syntax here)` と書かれている箇所に
に以下のフォーマットで加筆してください。

```AppleScript

	else if coloring style is "hoge" then	-- ""内にシンタックス名を入れます
		set beginDelimiter to "" -- ブロックコメントの開始記号（ブロックコメントがない場合は""のまま）
		set endDelimiter to "" -- ブロックコメントの終了記号
		set lineDelimiter to "" -- ラインコメントの開始記号（ラインコメントがない場合は""のまま）
		set allowMiddleOfLine to true -- これをfalseにするとラインコメントで常に行頭からコメントアウトされるようになります
```

クレジット
-------------
### 作者
1024jp

- website: [ヴォルフロッシュ](http://wolfrosch.com/)
- twitter: [1024jp](https://twitter.com/1024jp)
- github: [1024jp](https://github.com/1024jp)

### 配布ページ
- [CotEditor用スクリプト -Goodies -Works //ヴォルフロッシュ](http://wolfrosch.com/works/goodies/coteditor_comment)
- [repository on GitHub](https://github.com/1024jp/multiComment-CotEditor)

### フィードバック
不具合や要望などありましたら、[メールフォーム][]やTwitterで気軽にご連絡下さい。可能な限り対応させていただきます。単純な「使ってます」という声も励みになります。

[メールフォーム]: http://wolfrosch.com/about/contact

ライセンス
-------------
本スクリプトは [クリエイティブ・コモンズ 表示 - 非営利 3.0 非移植 ライセンス](cc) の下に提供されています。
[cc]: http://creativecommons.org/licenses/by-nc/3.0/deed.ja
