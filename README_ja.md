
Multi-Language Comment Script for CotEditor
================================================

CotEditor用のスクリプトです。
現在選択されているラーリング・シンタックスに合わせ適切なコメント記号で選択範囲をコメントアウトします。
ラインコメントはコメント解除もできます。
何も選択されていない場合はカーソル位置に空のコメント記号を挿入します。
お好みのショートカットキーを割り振って使うと便利だと思います（デフォルトは Command + Shift + C）。


対応している言語
-------------
CotEditor 1.3に同梱されているシンタックス（Perl, Ruby, PHPなど）
さらに、Apache, XML, HTML5, SVG, SQL,  Markdown, AppleScript, Go, Scheme, gnuplot, ImageJ, R および ReVIEW
（シンタックス名が一致する必要があります）


使い方
-------------
CotEditorのScriptMenuフォルダにスクリプトを入れて、スクリプトメニューからお使いください。

note: CotEditorのスクリプトメニューから「スクリプトフォルダを開く」を選択するとFinderで該当フォルダが開きます。


説明
-------------
1つのスクリプト（ショートカット）で、状況に対応しつつ自在にコメントアウト・解除を行うことを目指しています。
具体的な挙動は実際に使用しながら体感して貰うのが一番だと思いますが、細かい挙動については以下のようになっています。

- 選択範囲をコメントアウトし、テキストが選択されていない場合はカーソル位置にコメント記号を挿入します。

- 既にコメントアウトされている行が範囲範囲内で一定の割合を超える場合は、逆に選択範囲の コメントの解除 を行います。
  このしきい値となる割合は変更可能でデフォルトでは1/2です。
  ただし、このコメント解除はラインコメントのみで有効で、またそのコメント記号が行頭にある必要があります。

- 複数行が選択されているときは、選択範囲の開始/終了が行の途中でも選択されている行全てを対象に コメントアウト/解除 を行います。
  この動作は変更可能です。

- 行頭でのみコメントが許されている言語 (Apache と Shell Script) では常に、
  選択された行の行頭でコメントアウト・解除を行います。

- ラインコメントとブロックコメントの両方の方式を持つ言語では、
  選択された行が少ないときはラインコメント方式でコメントアウトします。
  このしきい値となる行数は変更可能でデフォルトでは10行です。
	
- 対応外のシンタックスのときは、実行しても特に何も起こりません。
  対応言語を追加したい場合は、スクリプトを開いて前半のif文の辺りに見よう見まねで適当に足してください。


拙[Blog][]にもスクリーンショット付きで解説をちょっと書いています。
[Blog]: http://wolfrosch.com/text/2012/02/25 "CotEditor 多言語コメントアウトScript"


カスタマイズ
-------------
### ショートカットキー
CotEditorスクリプトのショートカットキーはファイル名を変更することで設定可能です。
デフォルトのショートカットキーは Command + Shift + c です。
詳しくはCotEditorのヘルプを参照してください。

### スクリプト内で設定できる値
- `minBlockCommentLines`
	選択範囲がこの行数を超えたときにコメント方式をラインコメントからブロックコメントに切り替えます。
	
	デフォルト値：10行
	
- `commentLinesRate`
	選択範囲に含まれるコメント行の割合がこの値を超えたときに、動作をコメントアウトからコメント解除に切り替えます。
	
	デフォルト値：1/2

- `spacer`
	コメント記号の後に入る空白を設定できます。
	
	デフォルト値：半角空白1つ

- `forceWholeLines`
	複数行が選択されているとき、選択開始/終了位置の如何にかかわらず選択された行全体を動作の対象にします。
	falseの場合は1行の場合と同様、選択範囲の開始/終了位置にコメント記号を挿入し、
	またコメント解除の際に行頭から選択されていいない場合は最初の行の行頭コメントを評価しません。
	
	デフォルト値：true


作者
-------------
1024jp
- website: [ヴォルフロッシュ](http://wolfrosch.com/)
- twitter: @1024jp


ライセンス
-------------
本スクリプトは [クリエイティブ・コモンズ 表示 - 非営利 3.0 非移植 ライセンス](cc) の下に提供されています。
[cc]: http://creativecommons.org/licenses/by-nc/3.0/deed.ja


バージョンヒストリー
-------------
- 2012-03-xx v1.1 
	- 複数行が選択されているときは、選択範囲の開始/終了が行の途中でもその行頭/行末に対してコメントアウト/解除をするようになりました（変更可）
	- コメントが行頭でしか許されていない言語 (Apache, Shell Script) では常に行頭に対してコメントアウト/解除をするようになりました
	- ブロックコメント切り替えの設定行数に関わらず、選択範囲内のラインコメント数が一定割合を超えるときはコメント解除を行うようになりました
	- [fix] 対応している言語にRを含めていながらRの定義が入っていなかったので追加しました
	
		
- 2012-03-01 v1.0.1
	- バグフィックス
	
- 2012-02-25 v1.0 
	- 公開